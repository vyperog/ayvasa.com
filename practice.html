<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ayvasa Practice</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#0e1116">
  <!-- iOS / A2HS support -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Ayvasa">
  <link rel="apple-touch-icon" href="icons/icon.svg">
  <link rel="icon" href="icons/icon.svg" type="image/svg+xml">
</head>
<body data-page="practice">
  <header class="site-header">
    <a class="brand" href="index.html">AYVASA</a>
    <nav class="site-nav">
      <a class="button ghost" href="index.html">Protocol</a>
    </nav>
  </header>

  <main class="app-shell">
    <div class="surface">
      <div class="segmented" role="tablist" aria-label="Practice sections">
        <button class="segmented__tab is-active" data-view="practice" role="tab" aria-selected="true">Practice</button>
        <button class="segmented__tab" data-view="history" role="tab" aria-selected="false">History</button>
        <button class="segmented__tab" data-view="about" role="tab" aria-selected="false">About</button>
      </div>

      <section class="view" data-view="practice">
        <div class="practice-screen" data-step="idle">
          <h1>Practice</h1>
          <p class="muted">No alerts. No interruptions.</p>
          <div class="button-row">
            <button class="button primary" id="beginFlow">Begin New Session</button>
          </div>
        </div>

        <div class="practice-screen" data-step="entryState" hidden>
          <h2>Entry state (optional)</h2>
          <p class="practice-prompt">Notice the starting tone before practice.</p>
          <div class="field">
            <div class="chip-row" id="entryStateChips">
              <button class="chip" data-entry-state="settled">settled</button>
              <button class="chip" data-entry-state="neutral">neutral</button>
              <button class="chip" data-entry-state="activated">activated</button>
              <button class="chip" data-entry-state="scattered">scattered</button>
              <button class="chip" data-entry-state="fatigued">fatigued</button>
            </div>
          </div>
          <div class="button-row">
            <button class="button ghost" id="entrySkip">Skip</button>
            <button class="button ghost" id="entryCancel">Cancel</button>
          </div>
        </div>

        <div class="practice-screen practice-center" data-step="readyCircle" hidden>
          <h2>Ready</h2>
          <p class="practice-prompt">Tap the circle to begin the session.</p>
          <button class="session-circle" data-session-circle type="button">
            <span>Begin</span>
          </button>
          <button class="button ghost" id="readyCancel">Cancel</button>
        </div>

        <div class="practice-screen practice-center" data-step="inSession" hidden>
          <h2 id="sessionProgressTitle">Session in progress</h2>
          <p class="practice-prompt" id="sessionProgressPrompt">Tap the circle again to end the session.</p>
          <button class="session-circle is-pulsing" data-session-circle type="button">
            <span>End</span>
          </button>
        </div>

        <div class="practice-screen" data-step="post_phases" hidden>
          <h2>Phases practiced</h2>
          <p class="practice-prompt">Which phases did you practice today?</p>
          <div class="field">
            <div class="chip-row" id="phaseChips">
              <button class="chip" data-phase="all">All phases</button>
              <button class="chip" data-phase="0">Phase 0</button>
              <button class="chip" data-phase="1">Phase 1</button>
              <button class="chip" data-phase="2">Phase 2</button>
              <button class="chip" data-phase="3">Phase 3</button>
              <button class="chip" data-phase="4">Phase 4</button>
            </div>
          </div>
          <div class="button-row">
            <button class="button ghost" data-action="back">Back</button>
          </div>
        </div>

        <div class="practice-screen" data-step="post_tags" hidden>
          <h2>Experience tags</h2>
          <p class="practice-prompt">Select 1–2 tags.</p>
          <div class="field">
            <div class="chip-row" id="tagChips">
              <button class="chip" data-tag="quiet">quiet</button>
              <button class="chip" data-tag="neutral">neutral</button>
              <button class="chip" data-tag="scattered">scattered</button>
              <button class="chip" data-tag="settled">settled</button>
              <button class="chip" data-tag="light">light</button>
              <button class="chip" data-tag="ordinary">ordinary</button>
              <button class="chip" data-tag="effortful">effortful</button>
              <button class="chip" data-tag="unclear">unclear</button>
              <button class="chip" data-tag="spacious">spacious</button>
              <button class="chip" data-tag="compressed">compressed</button>
            </div>
          </div>
          <div class="button-row">
            <button class="button ghost" data-action="back">Back</button>
            <button class="button primary" id="tagsContinue">Next</button>
          </div>
        </div>

        <div class="practice-screen" data-step="post_interference" hidden>
          <h2>Interference level</h2>
          <p class="practice-prompt">How often did interference arise?</p>
          <div class="field">
            <div class="chip-row" id="interferenceChips">
              <button class="chip" data-interference="minimal">minimal</button>
              <button class="chip" data-interference="moderate">moderate</button>
              <button class="chip" data-interference="frequent">frequent</button>
            </div>
          </div>
          <div class="button-row">
            <button class="button ghost" data-action="back">Back</button>
          </div>
        </div>

        <div class="practice-screen" data-step="post_phase4" hidden>
          <h2>Phase 4 stillness estimate</h2>
          <p class="practice-prompt">Approximate time stillness felt available.</p>
          <div class="field">
            <div class="chip-row" id="phase4EstimateChips">
              <button class="chip" data-phase4-estimate="<1 min">&lt;1 min</button>
              <button class="chip" data-phase4-estimate="1–3 min">1–3 min</button>
              <button class="chip" data-phase4-estimate="3–6 min">3–6 min</button>
              <button class="chip" data-phase4-estimate="unknown / fluctuated">unknown / fluctuated</button>
            </div>
          </div>
          <div class="button-row">
            <button class="button ghost" data-action="back">Back</button>
          </div>
        </div>

        <div class="practice-screen" data-step="post_anchor" hidden>
          <h2>Somatic anchor</h2>
          <p class="practice-prompt">Where was coherence most noticeable?</p>
          <div class="field">
            <div class="chip-row" id="somaticAnchorChips">
              <button class="chip" data-somatic-anchor="palate">palate</button>
              <button class="chip" data-somatic-anchor="chest">chest</button>
              <button class="chip" data-somatic-anchor="spine">spine</button>
              <button class="chip" data-somatic-anchor="whole-body">whole-body</button>
              <button class="chip" data-somatic-anchor="diffuse / unclear">diffuse / unclear</button>
            </div>
          </div>
          <div class="button-row">
            <button class="button ghost" data-action="back">Back</button>
          </div>
        </div>

        <div class="practice-screen" data-step="post_reentry" hidden>
          <h2>Re-entry friction</h2>
          <p class="practice-prompt">Did re-entry feel abrupt?</p>
          <div class="field">
            <div class="chip-row" id="reentryChips">
              <button class="chip" data-reentry="yes">yes</button>
              <button class="chip" data-reentry="no">no</button>
            </div>
          </div>
          <div class="button-row">
            <button class="button ghost" data-action="back">Back</button>
          </div>
        </div>

        <div class="practice-screen" data-step="review" hidden>
          <h2>Review</h2>
          <p class="practice-prompt">Confirm the session details before saving.</p>
          <dl class="review-list" id="reviewSummary"></dl>
          <div class="button-row">
            <button class="button primary" id="saveSession">Save Session</button>
            <button class="button ghost" id="discardSession">Discard</button>
          </div>
        </div>
      </section>

      <section class="view" data-view="history" hidden>
        <h1>History</h1>
        <div class="filters">
          <label>
            Phase
            <select id="phaseFilter">
              <option value="">All</option>
              <option value="0">Phase 0</option>
              <option value="1">Phase 1</option>
              <option value="2">Phase 2</option>
              <option value="3">Phase 3</option>
              <option value="4">Phase 4</option>
            </select>
          </label>
          <label>
            Tag
            <select id="tagFilter">
              <option value="">All</option>
              <option value="quiet">quiet</option>
              <option value="neutral">neutral</option>
              <option value="scattered">scattered</option>
              <option value="settled">settled</option>
              <option value="light">light</option>
              <option value="ordinary">ordinary</option>
              <option value="effortful">effortful</option>
              <option value="unclear">unclear</option>
              <option value="spacious">spacious</option>
              <option value="compressed">compressed</option>
            </select>
          </label>
        </div>

        <div class="history-actions">
          <button class="button ghost" id="exportData">Export JSON</button>
          <label class="button ghost file-input">
            Import JSON
            <input type="file" id="importData" accept="application/json" />
          </label>
          <button class="button danger" id="clearAll">Clear All Data</button>
        </div>

        <div class="history-list" id="historyList"></div>
      </section>

      <section class="view" data-view="about" hidden>
  <h1>About</h1>

  <div class="prose">
    <p class="muted">
      Local-only practice space for the Coherence Protocol.
    </p>
    <p class="muted">
      No accounts. No tracking. No analysis. All your logged data stays on this device.
    </p>
    <p class="muted">
      The Coherence Protocol is a nervous system-first meditation practice for beginner, intermediate, and seasoned meditators. It's simple enough for people just starting a new meditation practice while precise enough for advanced practitioners.
    </p>
    <p class="muted">  
      Designed to reduce effort and self-monitoring, and make stillness more available—without chasing “perfect sessions.”
    </p>
    <p class="muted">
      Created by <strong>Ayah Aiwōn</strong>-longtime meditator and independent researcher—who has been exploring coherence, attention, and stability in daily life for 30+ years.
    </p>
    <p class="muted">
      If you want the full written guide and practice structure, see <a href="https://www.amazon.com/Coherence-Workbook-Biology-Grounded-Meditation-Integration-ebook/dp/B0GF2WBTCL/" target="_blank" rel="noopener noreferrer"><strong>The Coherence Workbook</strong></a>.
    </p>
  </div>
</section>
    </div>
    <div id="installPromo" class="install-promo" hidden>
      <span>Add Ayvasa to your home screen</span>
        <div class="install-promo__actions">
          <button id="installPromoPrimary" class="button primary">Install</button>
          <button id="installPromoDismiss" class="button ghost">Not now</button>
        </div>
      </div>
  </main>

  <div class="overlay install-overlay" id="installOverlay" hidden>
    <div class="overlay-scrim" data-install-close></div>
    <div class="overlay-card" role="dialog" aria-modal="true" aria-labelledby="installOverlayTitle">
      <button class="overlay-close" type="button" aria-label="Close" data-install-close>&times;</button>
      <h2 id="installOverlayTitle">Install Ayvasa</h2>
      <div class="overlay-body" id="installOverlayBody"></div>
      <div class="overlay-actions">
        <button class="button ghost" type="button" data-install-close>Close</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
